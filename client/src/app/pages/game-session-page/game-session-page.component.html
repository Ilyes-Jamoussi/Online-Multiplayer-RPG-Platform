<app-ui-page-layout [hasHeader]="true" [hasFooter]="false" [showBackButton]="true" headerTitle="Session de Jeu" (backClick)="onBack()">
    <div class="game-session-content">
        @if (gameId()) {
            <app-game-map [gameId]="gameId()"></app-game-map>
        } @else {
            <div class="error">
                <p>Aucune carte de jeu disponible</p>
                <p>Retourne à la salle d'attente et redémarre le jeu</p>
            </div>
        }
    </div>
    
    @if (gameId()) {
        <app-player-info></app-player-info>
        <app-game-info 
            [mapSize]="mapSize" 
            [activePlayer]="activePlayer">
        </app-game-info>
    }

    <!-- Game controls -->
    <div class="game-controls">
        <button [disabled]="disableStartButton" (click)="onStartGame()">Démarrer le tour</button>
        
        <!-- Debug info (à supprimer en production) -->
        <div class="debug-info">
            <p>Taille de carte: {{ inGameService.mapSize() }}</p>
            <p>Mode: {{ inGameService.mode() }}</p>
            <p>Numéro de tour: {{ inGameService.turnNumber() }}</p>
            <p>Jeu démarré: {{ inGameService.isGameStarted() }}</p>
            <p>Mon tour: {{ inGameService.isMyTurn() }}</p>
            <p>Temps restant: {{ inGameService.timeRemaining() }}</p>
        </div>
    </div>
</app-ui-page-layout>

@if (inGameService.isTransitioning()) {
<div class="transition-overlay" (click)="$event.stopPropagation()">
    <div class="transition-modal">
        <h2>{{ transitionMessage }}</h2>
        <div class="loading-spinner">
            <p>{{ inGameService.timeRemaining() }}</p>
        </div>
    </div>
</div>
}
