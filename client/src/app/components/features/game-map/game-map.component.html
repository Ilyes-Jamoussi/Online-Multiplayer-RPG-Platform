<div class="game-map-wrapper">
    @if (loading) {
        <div class="loading">
            <p>Chargement de la carte...</p>
        </div>
    } @else if (error) {
        <div class="error">
            <p>Erreur lors du chargement de la carte</p>
        </div>
    } @else if (tiles.length > 0) {
        <div class="map-container">
            <div
                class="map-grid"
                [ngStyle]="{
                    'grid-template-columns': 'repeat(' + size + ', 1fr)',
                    'grid-template-rows': 'repeat(' + size + ', 1fr)'
                }"
            >
                <!-- Affichage des tuiles avec vraies images -->
                @for (tile of tiles; track tile.x + '-' + tile.y) {
                    <div 
                        class="map-tile"
                        [title]="tile.kind + ' (' + tile.x + ',' + tile.y + ')'"
                    >
                        <img 
                            [src]="getTileImage(tile.kind, tile.open)" 
                            [alt]="tile.kind"
                            class="tile-image"
                        />
                    </div>
                }
            </div>
            
            <!-- Overlay pour les objets avec vraies dimensions -->
            <div
                class="objects-overlay"
                [ngStyle]="{
                    'grid-template-columns': 'repeat(' + size + ', 1fr)',
                    'grid-template-rows': 'repeat(' + size + ', 1fr)'
                }"
            >
                @for (obj of objects; track obj.id) {
                    @if (obj.placed) {
                        <div 
                            class="map-object"
                            [ngStyle]="{
                                'grid-column': (obj.x + 1) + ' / span ' + getObjectFootprint(obj.kind),
                                'grid-row': (obj.y + 1) + ' / span ' + getObjectFootprint(obj.kind)
                            }"
                            [title]="obj.kind + ' (' + obj.x + ',' + obj.y + ')'"
                        >
                            <img 
                                [src]="getPlaceableImage(obj.kind)" 
                                [alt]="obj.kind"
                                class="object-image"
                            />
                        </div>
                    }
                }
            </div>
        </div>
    } @else {
        <div class="empty">
            <p>Aucune donn√©e de carte disponible</p>
        </div>
    }
</div>
