@if (activeTile) {
<div class="tile-modal-backdrop" (click)="close()"></div>
<div class="tile-modal" role="dialog" aria-modal="true">
    <button class="tile-modal__close" (click)="close()" aria-label="Fermer">
        <i class="material-icons">close</i>
    </button>

    <header class="tile-modal__header">
        <div class="tile-icon">
            <i class="material-icons">grid_on</i>
        </div>
        <div class="tile-header-content">
            <h3>{{ tileLabel[activeTile.kind] }}</h3>
            <span class="tile-type">{{ activeTile.kind }}</span>
        </div>
    </header>

    <div class="tile-modal__body">
        <section class="info-card">
            <div class="info-card__header">
                <i class="material-icons">info</i>
                <h4>Characteristics</h4>
            </div>
            <div class="info-grid">
                <div class="info-item">
                    <span class="info-label">Position</span>
                    <span class="info-value">({{ activeTile.x }}, {{ activeTile.y }})</span>
                </div>
                @if(activeTile.kind === tileKind.DOOR){
                <div class="info-item">
                    <span class="info-label">State</span>
                    <span class="info-value">
                        <span class="status-badge" [class.status-open]="activeTile.open" [class.status-closed]="!activeTile.open">
                            {{ activeTile.open ? 'Open' : 'Closed' }}
                        </span>
                    </span>
                </div>
                } @if (activeTile.teleportChannel !== undefined) {
                <div class="info-item">
                    <span class="info-label">Teleportation</span>
                    <span class="info-value">Channel {{ activeTile.teleportChannel }}</span>
                </div>
                } @if (startPointOnTile) {
                <div class="info-item">
                    <span class="info-label">Starting point of</span>
                    <span class="info-value">
                        @if (startPointOnTile.player) {
                        {{ startPointOnTile.player.name }}
                        } @else { Player {{ startPointOnTile.playerId }}
                        }
                    </span>
                </div>
                }
            </div>
        </section>

        @if (objectOnTile) {
        <section class="info-card">
            <div class="info-card__header">
                <i class="material-icons">category</i>
                <h4>Object on Tile</h4>
            </div>
            <div class="object-display">
                <div class="object-image-wrapper">
                    <img [src]="getObjectImage(objectOnTile.kind)" [alt]="objectOnTile.kind" loading="lazy" />
                </div>
                <div class="object-details">
                    <div class="object-name">{{ placeableLabel[objectOnTile.kind] }}</div>
                    <div class="object-type">{{ objectOnTile.kind }}</div>
                </div>
            </div>
        </section>
        } @if (playerOnTile) {
        <section class="info-card">
            <div class="info-card__header">
                <i class="material-icons">person</i>
                <h4>Player on Tile</h4>
            </div>
            <div class="player-display">
                <div class="player-avatar-wrapper">
                    <img class="player-avatar" [src]="getPlayerAvatar(playerOnTile.id)" [alt]="playerOnTile.name" loading="lazy" />
                    @if (hasFlag(playerOnTile)) {
                    <div class="flag-indicator">ðŸš©</div>
                    }
                </div>
                <div class="player-details">
                    <div class="player-name">{{ playerOnTile.name }}</div>
                    @if (getTeamNumber(playerOnTile) !== undefined) {
                    <div class="team-badge" [style.background-color]="getTeamColor(getTeamNumber(playerOnTile))">
                        Team {{ getTeamNumber(playerOnTile) }}
                    </div>
                    }
                </div>
            </div>
        </section>
        } @if (!objectOnTile && !playerOnTile) {
        <section class="info-card empty-state">
            <i class="material-icons">check_circle</i>
            <p>This tile is empty</p>
        </section>
        }
    </div>
</div>
}
